<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   <title>Chapter&nbsp;15.&nbsp;Troubleshooting and Debugging Apache HBase</title><link rel="stylesheet" type="text/css" href="../css/freebsd_docbook.css"><meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1"><link rel="home" href="book.html" title="The Apache HBase&#153; Reference Guide"><link rel="up" href="book.html" title="The Apache HBase&#153; Reference Guide"><link rel="prev" href="perf.casestudy.html" title="14.14.&nbsp;Case Studies"><link rel="next" href="trouble.log.html" title="15.2.&nbsp;Logs"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Chapter&nbsp;15.&nbsp;Troubleshooting and Debugging Apache HBase</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="perf.casestudy.html">Prev</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="trouble.log.html">Next</a></td></tr></table><hr></div><script type="text/javascript">
    var disqus_shortname = 'hbase'; // required: replace example with your forum shortname
    var disqus_url = 'http://hbase.apache.org/book/trouble.html';
    </script><div class="chapter" title="Chapter&nbsp;15.&nbsp;Troubleshooting and Debugging Apache HBase"><div class="titlepage"><div><div><h2 class="title"><a name="trouble"></a>Chapter&nbsp;15.&nbsp;Troubleshooting and Debugging Apache HBase</h2></div></div></div><div class="toc"><p><b>Table of Contents</b></p><dl><dt><span class="section"><a href="trouble.html#trouble.general">15.1. General Guidelines</a></span></dt><dt><span class="section"><a href="trouble.log.html">15.2. Logs</a></span></dt><dd><dl><dt><span class="section"><a href="trouble.log.html#trouble.log.locations">15.2.1. Log Locations</a></span></dt><dt><span class="section"><a href="trouble.log.html#trouble.log.levels">15.2.2. Log Levels</a></span></dt><dt><span class="section"><a href="trouble.log.html#trouble.log.gc">15.2.3. JVM Garbage Collection Logs</a></span></dt></dl></dd><dt><span class="section"><a href="trouble.resources.html">15.3. Resources</a></span></dt><dd><dl><dt><span class="section"><a href="trouble.resources.html#trouble.resources.searchhadoop">15.3.1. search-hadoop.com</a></span></dt><dt><span class="section"><a href="trouble.resources.html#trouble.resources.lists">15.3.2. Mailing Lists</a></span></dt><dt><span class="section"><a href="trouble.resources.html#trouble.resources.irc">15.3.3. IRC</a></span></dt><dt><span class="section"><a href="trouble.resources.html#trouble.resources.jira">15.3.4. JIRA</a></span></dt></dl></dd><dt><span class="section"><a href="trouble.tools.html">15.4. Tools</a></span></dt><dd><dl><dt><span class="section"><a href="trouble.tools.html#trouble.tools.builtin">15.4.1. Builtin Tools</a></span></dt><dt><span class="section"><a href="trouble.tools.html#trouble.tools.external">15.4.2. External Tools</a></span></dt></dl></dd><dt><span class="section"><a href="trouble.client.html">15.5. Client</a></span></dt><dd><dl><dt><span class="section"><a href="trouble.client.html#trouble.client.scantimeout">15.5.1. ScannerTimeoutException or UnknownScannerException</a></span></dt><dt><span class="section"><a href="trouble.client.html#d2875e15701">15.5.2. Performance Differences in Thrift and Java APIs</a></span></dt><dt><span class="section"><a href="trouble.client.html#trouble.client.lease.exception">15.5.3. <code class="classname">LeaseException</code> when calling
        <code class="classname">Scanner.next</code></a></span></dt><dt><span class="section"><a href="trouble.client.html#trouble.client.scarylogs">15.5.4. Shell or client application throws lots of scary exceptions during normal
        operation</a></span></dt><dt><span class="section"><a href="trouble.client.html#trouble.client.longpauseswithcompression">15.5.5. Long Client Pauses With Compression</a></span></dt><dt><span class="section"><a href="trouble.client.html#trouble.client.security.rpc.krb">15.5.6. Secure Client Connect ([Caused by GSSException: No valid credentials provided...])</a></span></dt><dt><span class="section"><a href="trouble.client.html#trouble.client.zookeeper">15.5.7. ZooKeeper Client Connection Errors</a></span></dt><dt><span class="section"><a href="trouble.client.html#trouble.client.oome.directmemory.leak">15.5.8. Client running out of memory though heap size seems to be stable (but the
        off-heap/direct heap keeps growing)</a></span></dt><dt><span class="section"><a href="trouble.client.html#trouble.client.slowdown.admin">15.5.9. Client Slowdown When Calling Admin Methods (flush, compact, etc.)</a></span></dt><dt><span class="section"><a href="trouble.client.html#trouble.client.security.rpc">15.5.10. Secure Client Cannot Connect ([Caused by GSSException: No valid credentials provided
        (Mechanism level: Failed to find any Kerberos tgt)])</a></span></dt></dl></dd><dt><span class="section"><a href="trouble.mapreduce.html">15.6. MapReduce</a></span></dt><dd><dl><dt><span class="section"><a href="trouble.mapreduce.html#trouble.mapreduce.local">15.6.1. You Think You're On The Cluster, But You're Actually Local</a></span></dt><dt><span class="section"><a href="trouble.mapreduce.html#trouble.hbasezerocopybytestring">15.6.2. Launching a job, you get java.lang.IllegalAccessError: com/google/protobuf/HBaseZeroCopyByteString or class com.google.protobuf.ZeroCopyLiteralByteString cannot access its superclass com.google.protobuf.LiteralByteString</a></span></dt></dl></dd><dt><span class="section"><a href="trouble.namenode.html">15.7. NameNode</a></span></dt><dd><dl><dt><span class="section"><a href="trouble.namenode.html#trouble.namenode.disk">15.7.1. HDFS Utilization of Tables and Regions</a></span></dt><dt><span class="section"><a href="trouble.namenode.html#trouble.namenode.hbase.objects">15.7.2. Browsing HDFS for HBase Objects</a></span></dt></dl></dd><dt><span class="section"><a href="trouble.network.html">15.8. Network</a></span></dt><dd><dl><dt><span class="section"><a href="trouble.network.html#trouble.network.spikes">15.8.1. Network Spikes</a></span></dt><dt><span class="section"><a href="trouble.network.html#trouble.network.loopback">15.8.2. Loopback IP</a></span></dt><dt><span class="section"><a href="trouble.network.html#trouble.network.ints">15.8.3. Network Interfaces</a></span></dt></dl></dd><dt><span class="section"><a href="trouble.rs.html">15.9. RegionServer</a></span></dt><dd><dl><dt><span class="section"><a href="trouble.rs.html#trouble.rs.startup">15.9.1. Startup Errors</a></span></dt><dt><span class="section"><a href="trouble.rs.html#trouble.rs.runtime">15.9.2. Runtime Errors</a></span></dt><dt><span class="section"><a href="trouble.rs.html#d2875e16247">15.9.3. Snapshot Errors Due to Reverse DNS</a></span></dt><dt><span class="section"><a href="trouble.rs.html#trouble.rs.shutdown">15.9.4. Shutdown Errors</a></span></dt></dl></dd><dt><span class="section"><a href="trouble.master.html">15.10. Master</a></span></dt><dd><dl><dt><span class="section"><a href="trouble.master.html#trouble.master.startup">15.10.1. Startup Errors</a></span></dt><dt><span class="section"><a href="trouble.master.html#trouble.master.shutdown">15.10.2. Shutdown Errors</a></span></dt></dl></dd><dt><span class="section"><a href="trouble.zookeeper.html">15.11. ZooKeeper</a></span></dt><dd><dl><dt><span class="section"><a href="trouble.zookeeper.html#trouble.zookeeper.startup">15.11.1. Startup Errors</a></span></dt><dt><span class="section"><a href="trouble.zookeeper.html#trouble.zookeeper.general">15.11.2. ZooKeeper, The Cluster Canary</a></span></dt></dl></dd><dt><span class="section"><a href="trouble.ec2.html">15.12. Amazon EC2</a></span></dt><dd><dl><dt><span class="section"><a href="trouble.ec2.html#trouble.ec2.zookeeper">15.12.1. ZooKeeper does not seem to work on Amazon EC2</a></span></dt><dt><span class="section"><a href="trouble.ec2.html#trouble.ec2.instability">15.12.2. Instability on Amazon EC2</a></span></dt><dt><span class="section"><a href="trouble.ec2.html#trouble.ec2.connection">15.12.3. Remote Java Connection into EC2 Cluster Not Working</a></span></dt></dl></dd><dt><span class="section"><a href="trouble.versions.html">15.13. HBase and Hadoop version issues</a></span></dt><dd><dl><dt><span class="section"><a href="trouble.versions.html#trouble.versions.205">15.13.1. <code class="code">NoClassDefFoundError</code> when trying to run 0.90.x on hadoop-0.20.205.x (or hadoop-1.0.x)</a></span></dt><dt><span class="section"><a href="trouble.versions.html#trouble.wrong.version">15.13.2. ...cannot communicate with client version...</a></span></dt></dl></dd><dt><span class="section"><a href="ch15s14.html">15.14. IPC Configuration Conflicts with Hadoop</a></span></dt><dt><span class="section"><a href="ch15s15.html">15.15. HBase and HDFS</a></span></dt><dt><span class="section"><a href="trouble.tests.html">15.16. Running unit or integration tests</a></span></dt><dd><dl><dt><span class="section"><a href="trouble.tests.html#trouble.HDFS-2556">15.16.1. Runtime exceptions from MiniDFSCluster when running tests</a></span></dt></dl></dd><dt><span class="section"><a href="trouble.casestudy.html">15.17. Case Studies</a></span></dt><dt><span class="section"><a href="trouble.crypto.html">15.18. Cryptographic Features</a></span></dt><dd><dl><dt><span class="section"><a href="trouble.crypto.html#trouble.crypto.HBASE-10132">15.18.1. sun.security.pkcs11.wrapper.PKCS11Exception: CKR_ARGUMENTS_BAD</a></span></dt></dl></dd><dt><span class="section"><a href="ch15s19.html">15.19. Operating System Specific Issues</a></span></dt><dd><dl><dt><span class="section"><a href="ch15s19.html#d2875e16809">15.19.1. Page Allocation Failure</a></span></dt></dl></dd><dt><span class="section"><a href="ch15s20.html">15.20. JDK Issues</a></span></dt><dd><dl><dt><span class="section"><a href="ch15s20.html#d2875e16851">15.20.1. NoSuchMethodError: java.util.concurrent.ConcurrentHashMap.keySet</a></span></dt></dl></dd></dl></div><div class="section" title="15.1.&nbsp;General Guidelines"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="trouble.general"></a>15.1.&nbsp;General Guidelines</h2></div></div></div><p> Always start with the master log (TODO: Which lines?). Normally it&#8217;s just printing the
      same lines over and over again. If not, then there&#8217;s an issue. Google or <a class="link" href="http://search-hadoop.com" target="_top">search-hadoop.com</a> should return some hits for
      those exceptions you&#8217;re seeing. </p><p> An error rarely comes alone in Apache HBase, usually when something gets screwed up what
      will follow may be hundreds of exceptions and stack traces coming from all over the place. The
      best way to approach this type of problem is to walk the log up to where it all began, for
      example one trick with RegionServers is that they will print some metrics when aborting so
      grepping for <span class="emphasis"><em>Dump</em></span> should get you around the start of the problem. </p><p> RegionServer suicides are &#8220;normal&#8221;, as this is what they do when something goes wrong.
      For example, if ulimit and max transfer threads (the two most important initial settings, see
      <a class="xref" href="configuration.html#ulimit">Limits on Number of Files and Processes (<span class="command"><strong>ulimit</strong></span>)
          </a><a class="indexterm" name="d2875e1308"></a><a class="xref" href="configuration.html#ulimit"></a><a class="indexterm" name="d2875e1311"></a><a class="xref" href="configuration.html#ulimit">
        </a> and <a class="xref" href="configuration.html#dfs.datanode.max.transfer.threads" title="2.1.1.6.&nbsp;dfs.datanode.max.transfer.threads">Section&nbsp;2.1.1.6, &#8220;<code class="varname">dfs.datanode.max.transfer.threads</code>&#8221;</a>) aren&#8217;t
      changed, it will make it impossible at some point for DataNodes
      to create new threads that from the HBase point of view is seen as if HDFS was gone. Think
      about what would happen if your MySQL database was suddenly unable to access files on your
      local file system, well it&#8217;s the same with HBase and HDFS. Another very common reason to see
      RegionServers committing seppuku is when they enter prolonged garbage collection pauses that
      last longer than the default ZooKeeper session timeout. For more information on GC pauses, see
      the <a class="link" href="http://www.cloudera.com/blog/2011/02/avoiding-full-gcs-in-hbase-with-memstore-local-allocation-buffers-part-1/" target="_top">3
        part blog post</a> by Todd Lipcon and <a class="xref" href="jvm.html#gcpause" title="14.3.1.1.&nbsp;Long GC pauses">Section&nbsp;14.3.1.1, &#8220;Long GC pauses&#8221;</a> above. </p></div></div><div id="disqus_thread"></div><script type="text/javascript">
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="perf.casestudy.html">Prev</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="trouble.log.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">14.14.&nbsp;Case Studies&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="book.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;15.2.&nbsp;Logs</td></tr></table></div></body></html>